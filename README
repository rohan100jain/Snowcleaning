Attempt at the top coder Marathon Match 79.
